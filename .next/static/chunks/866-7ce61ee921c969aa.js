"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[866],{6635:function(e,t,s){s.r(t),s.d(t,{default:function(){return g}});var a=s(7437),r=s(2265),l=s(4007),n=s(7907),i=s(1310),o=s(2060),d=s(2278),c=s(8621),m=s(7132),u=s.n(m),x=s(9540);function h(e){let{isOpen:t,onClose:s,onCapture:n}=e,i=(0,r.useRef)(null),[o,d]=(0,r.useState)(!1),[m,h]=(0,r.useState)(null),[g,b]=(0,r.useState)({name:"",email:"",phone:"",rawText:""}),f=(0,r.useCallback)(async()=>{var e;let t=null===(e=i.current)||void 0===e?void 0:e.getScreenshot();if(!t){h("Failed to capture image. Please try again.");return}await p(t)},[i]),p=async e=>{try{var t,a,r;d(!0);let l=(0,x.createScheduler)(),i=await (0,x.createWorker)();await i.loadLanguage("eng"),await i.initialize("eng"),l.addWorker(i);let{data:{text:o}}=await l.addJob("recognize",e);await l.terminate();let c=o.split("\n").filter(e=>e.trim()),m=null===(t=c[0])||void 0===t?void 0:t.trim(),u=null===(a=c.find(e=>e.includes("@")))||void 0===a?void 0:a.trim(),h=null===(r=c.find(e=>e.match(/[\d-+()]{10,}/)))||void 0===r?void 0:r.trim(),g={name:m||"",email:u||"",phone:h||"",rawText:o};b(g),n(e,g),s()}catch(e){console.error("Error processing image:",e),h("Failed to process image. Please try again.")}finally{d(!1)}};return(0,a.jsxs)(l.Vq,{open:t,onClose:s,className:"relative z-50",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,a.jsx)(l.Vq.Panel,{className:"mx-auto max-w-sm rounded-lg bg-white",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:s,className:"absolute right-2 top-2 text-gray-400 hover:text-gray-500",children:(0,a.jsx)(c.Z,{className:"h-6 w-6"})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)(l.Vq.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"Capture Business Card"}),(0,a.jsxs)("div",{className:"relative aspect-[1.75] bg-gray-100 rounded-lg overflow-hidden mb-4",children:[(0,a.jsx)(u(),{ref:i,screenshotFormat:"image/jpeg",className:"absolute inset-0 w-full h-full object-cover",videoConstraints:{width:1280,height:720,facingMode:"environment"}}),(0,a.jsx)("div",{className:"absolute inset-0 border-2 border-dashed border-gray-400 rounded-lg"})]}),m&&(0,a.jsx)("p",{className:"text-sm text-red-600 mb-4",children:m}),(0,a.jsx)("div",{className:"mt-4 flex justify-end",children:(0,a.jsx)("button",{type:"button",className:"inline-flex justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",onClick:f,disabled:o,children:o?"Processing...":"Capture"})})]})]})})})]})}function g(e){let{onCardAdded:t}=e,s=(0,n.useRouter)(),[c,m]=(0,r.useState)(!1),[u,x]=(0,r.useState)(!1),[g,b]=(0,r.useState)(null),[f,p]=(0,r.useState)(null),[v,j]=(0,r.useState)(!1),[y,N]=(0,r.useState)({name:"",title:"",company:"",email:"",phone:"",website:"",notes:""}),w=async e=>{e.preventDefault(),j(!0),p(null);try{let e=new FormData;if(Object.entries(y).forEach(t=>{let[s,a]=t;a&&e.append(s,a)}),g){let t=await fetch(g),s=await t.blob();e.append("image",s,"card.jpg")}if(!(await fetch("/api/cards",{method:"POST",body:e})).ok)throw Error("Failed to create card");s.refresh(),m(!1),C(),null==t||t()}catch(e){console.error("Error creating card:",e),p("Failed to create card. Please try again.")}finally{j(!1)}},C=()=>{N({name:"",title:"",company:"",email:"",phone:"",website:"",notes:""}),b(null),p(null)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>m(!0),className:"inline-flex items-center rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600",children:[(0,a.jsx)(i.Z,{className:"h-5 w-5 mr-1"}),"Add Card"]}),(0,a.jsxs)(l.Vq,{open:c,onClose:()=>m(!1),className:"relative z-50",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,a.jsx)(l.Vq.Panel,{className:"mx-auto max-w-lg w-full bg-white rounded-xl shadow-lg",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)(l.Vq.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"Add Business Card"}),(0,a.jsx)("form",{onSubmit:w,children:(0,a.jsxs)("div",{className:"space-y-4",children:[g?(0,a.jsxs)("div",{className:"relative w-full aspect-[1.75] mb-4",children:[(0,a.jsx)("img",{src:g,alt:"Business card preview",className:"w-full h-full object-cover rounded-lg"}),(0,a.jsx)("button",{type:"button",onClick:()=>x(!0),className:"absolute bottom-2 right-2 bg-white/80 p-2 rounded-full hover:bg-white",children:(0,a.jsx)(o.Z,{className:"h-5 w-5 text-gray-600"})})]}):(0,a.jsx)("button",{type:"button",onClick:()=>x(!0),className:"w-full aspect-[1.75] flex items-center justify-center border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(o.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("span",{className:"mt-2 block text-sm font-medium text-gray-600",children:"Capture Business Card"})]})}),(0,a.jsx)(d.Z,{label:"Name",value:y.name,onChange:e=>N({...y,name:e.target.value}),required:!0}),(0,a.jsx)(d.Z,{label:"Title",value:y.title,onChange:e=>N({...y,title:e.target.value})}),(0,a.jsx)(d.Z,{label:"Company",value:y.company,onChange:e=>N({...y,company:e.target.value})}),(0,a.jsx)(d.Z,{label:"Email",type:"email",value:y.email,onChange:e=>N({...y,email:e.target.value})}),(0,a.jsx)(d.Z,{label:"Phone",type:"tel",value:y.phone,onChange:e=>N({...y,phone:e.target.value})}),(0,a.jsx)(d.Z,{label:"Website",type:"url",value:y.website,onChange:e=>N({...y,website:e.target.value})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),(0,a.jsx)("textarea",{value:y.notes,onChange:e=>N({...y,notes:e.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),f&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:f}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{m(!1),C()},className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:v,className:"inline-flex justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:v?"Saving...":"Save"})]})]})})]})})})]}),u&&(0,a.jsx)(h,{isOpen:u,onCapture:(e,t)=>{b(e),N(e=>({...e,name:t.name||e.name,email:t.email||e.email,phone:t.phone||e.phone,notes:t.rawText||e.notes})),x(!1),m(!0)},onClose:()=>x(!1)})]})}},4873:function(e,t,s){s.r(t),s.d(t,{default:function(){return f}});var a=s(7437),r=s(2265),l=s(7907),n=s(2278),i=s(4007),o=s(8621),d=s(9044),c=s(3251),m=s(2707),u=s(32),x=s(248);function h(e){let{card:t,onClose:s}=e,h=(0,l.useRouter)(),[g,b]=(0,r.useState)(!1),[f,p]=(0,r.useState)(!1),[v,j]=(0,r.useState)(""),[y,N]=(0,r.useState)(null),w=(0,r.useRef)(null);async function C(e){e.preventDefault(),N(null);try{if(!(await fetch("/api/cards/".concat(t.id,"/share"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:v})})).ok)throw Error("Failed to share card");p(!1),j("")}catch(e){e instanceof Error&&N(e.message)}}async function k(){try{if(!(await fetch("/api/cards/".concat(t.id),{method:"DELETE"})).ok)throw Error("Failed to delete card");s(),h.refresh()}catch(e){e instanceof Error&&N(e.message)}}return(0,r.useEffect)(()=>{function e(e){w.current&&!w.current.contains(e.target)&&s()}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[s]),x.z.object({name:x.z.string().min(1,"Name is required"),title:x.z.string().optional(),company:x.z.string().optional(),email:x.z.string().email("Invalid email format").optional().or(x.z.literal("")),phone:x.z.string().optional(),website:x.z.string().optional(),notes:x.z.string().optional(),category:x.z.string().optional()}),(0,a.jsxs)(i.Vq,{open:!0,onClose:s,className:"relative z-50",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,a.jsx)(i.Vq.Panel,{ref:w,className:"mx-auto max-w-lg w-full bg-white rounded-xl shadow-lg",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(i.Vq.Title,{className:"text-lg font-medium text-gray-900",children:"View Business Card"}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-500",children:(0,a.jsx)(o.Z,{className:"h-6 w-6"})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[y&&(0,a.jsx)("div",{className:"bg-red-50 text-red-700 p-4 rounded-md text-sm",children:y}),f?(0,a.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,a.jsx)(n.Z,{type:"email",label:"Email address",value:v,onChange:e=>j(e.target.value),required:!0}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>p(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",children:"Share"})]})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:t.name}),t.title&&(0,a.jsx)("p",{className:"text-gray-600",children:t.title})]}),t.company&&(0,a.jsxs)("div",{className:"flex items-center text-gray-500",children:[(0,a.jsx)(d.Z,{className:"h-5 w-5 mr-2"}),t.company]}),t.phone&&(0,a.jsxs)("div",{className:"flex items-center text-gray-500",children:[(0,a.jsx)(c.Z,{className:"h-5 w-5 mr-2"}),(0,a.jsx)("a",{href:"tel:".concat(t.phone),className:"hover:text-blue-600",children:t.phone})]}),t.email&&(0,a.jsxs)("div",{className:"flex items-center text-gray-500",children:[(0,a.jsx)(m.Z,{className:"h-5 w-5 mr-2"}),(0,a.jsx)("a",{href:"mailto:".concat(t.email),className:"hover:text-blue-600",children:t.email})]}),t.website&&(0,a.jsxs)("div",{className:"flex items-center text-gray-500",children:[(0,a.jsx)(u.Z,{className:"h-5 w-5 mr-2"}),(0,a.jsx)("a",{href:t.website.startsWith("http")?t.website:"https://".concat(t.website),target:"_blank",rel:"noopener noreferrer",className:"hover:text-blue-600",children:t.website})]}),t.notes&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Notes"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm whitespace-pre-wrap",children:t.notes})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)("button",{onClick:()=>p(!0),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Share"}),(0,a.jsx)("button",{onClick:k,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700",children:"Delete"})]})]})]})]})})})]})}var g=s(1040),b=s(703);function f(e){let{cards:t}=e,[s,l]=(0,r.useState)(null);return(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 p-4",children:[t.map(e=>(0,a.jsxs)("div",{onClick:()=>l(e),className:"relative group bg-white p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-gray-200",children:[(0,a.jsx)("div",{className:"relative w-full aspect-[1.75] mb-3",children:e.imageUrl?(0,a.jsx)(b.default,{src:e.imageUrl,alt:"".concat(e.name,"'s business card"),width:350,height:200,className:"object-cover rounded-md w-full h-full",sizes:"(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 25vw",priority:!0,onError:t=>{let s=t.target;s.src=e.imageUrl||"",s.onerror=null}}):(0,a.jsx)("div",{className:"absolute inset-0 bg-gray-100 rounded-md flex items-center justify-center",children:(0,a.jsx)(g.Z,{className:"w-12 h-12 text-gray-400"})})}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:e.name}),e.title&&(0,a.jsx)("p",{className:"text-sm text-gray-600 truncate",children:e.title}),e.company&&(0,a.jsx)("p",{className:"text-sm text-gray-500 truncate",children:e.company})]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-400 truncate",children:["Added by ",e.owner.name||e.owner.email]})]},e.id)),s&&(0,a.jsx)(h,{card:s,onClose:()=>l(null)})]})}},2278:function(e,t,s){var a=s(7437),r=s(2265),l=s(1367);let n=(0,r.forwardRef)((e,t)=>{let{className:s,label:r,error:n,icon:i,type:o="text",variant:d="light",...c}=e;return(0,a.jsxs)("div",{className:"w-full",children:[r&&(0,a.jsx)("label",{className:(0,l.m6)("block text-sm font-medium leading-6 mb-2","dark"===d?"text-gray-100":"text-gray-900"),children:r}),(0,a.jsxs)("div",{className:"relative rounded-md shadow-sm",children:[i&&(0,a.jsx)("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:(0,a.jsx)("div",{className:"dark"===d?"text-gray-400":"text-gray-500",children:i})}),(0,a.jsx)("input",{type:o,className:(0,l.m6)("block w-full rounded-md border-0 py-2.5 px-3 ring-1 ring-inset \n              focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6\n              disabled:cursor-not-allowed disabled:opacity-50","dark"===d?"bg-gray-800 text-white ring-gray-700 placeholder:text-gray-500 focus:ring-blue-500":"bg-white text-gray-900 ring-gray-300 placeholder:text-gray-400 focus:ring-blue-600",i&&"pl-10",n&&"ring-red-300 focus:ring-red-500",s),ref:t,...c}),n&&(0,a.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-red-500",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})})})]}),n&&(0,a.jsx)("p",{className:(0,l.m6)("mt-2 text-sm","dark"===d?"text-red-400":"text-red-600"),children:n})]})});n.displayName="Input",t.Z=n}}]);